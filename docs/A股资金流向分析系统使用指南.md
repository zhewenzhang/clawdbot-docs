# A 股资金流向分析系统使用指南

## 概述

本系统基于 TuShare API，提供 A 股资金流向的实时监控和分析功能。

## 系统功能

### 1. 核心分析系统 (`a_stock_money_flow_analysis.py`)

**功能:**
- 获取沪深港通资金流向
- 分析个股资金流向
- 监控融资融券数据
- 生成市场情绪报告

**使用方法:**
```bash
cd scripts
python3 a_stock_money_flow_analysis.py
```

**输出示例:**
```
============================================================
A 股资金流向分析
分析周期: 20260130 - 20260204
============================================================

[1] 获取市场资金汇总...
[HSGT] 获取 1 条记录

[2] 生成分析报告...

============================================================
市场分析报告
============================================================
交易日期: 20260204
北向资金: 322,904.44
南向资金: 51,878.37
市场情绪: bullish
市场洞察: 北向资金大幅流入，市场情绪积极
============================================================
```

### 2. 行业分析模板 (`sector_analysis_template.py`)

**功能:**
- 预设 7 个主要行业（银行、券商、医药、半导体、新能源、消费、科技）
- 自动获取各行业资金流向
- 生成行业对比报告

**使用方法:**
```bash
python3 sector_analysis_template.py
```

### 3. 监控告警 (`money_flow_alert.py`)

**功能:**
- 监控主力资金大幅流入/流出
- 监控资金集中度突变
- 监控散户情绪

**使用方法:**
```bash
python3 money_flow_alert.py
```

### 4. 定时任务 (`money_flow_cron.py`)

**功能:**
- 每日收盘后自动更新数据
- 每周生成行业报告
- 每月生成月报

**安装 crontab:**
```bash
python3 money_flow_cron.py install
```

**查看 crontab 配置:**
```bash
python3 money_flow_cron.py show
```

## 数据存储

```
data/money_flow/
├── industry/          # 行业资金数据
│   └── sector_银行_20260204.csv
├── daily/             # 每日资金数据
│   └── daily_report_20260204.json
└── alert_report_*.json  # 告警报告
```

## 定时任务配置

| 任务 | 时间 | 说明 |
|-----|------|------|
| daily_update | 周一至周五 16:00 | 每日资金流向分析 |
| weekly_report | 周五 17:00 | 每周行业报告 |
| monthly_report | 每月1日 9:00 | 每月资金流向月报 |
| alert_check | 工作日 9/12/15/16时 | 资金流向监控告警 |

## 注意事项

1. **TuShare Token**: 需要有效的 Token 才能访问数据
2. **API 积分**: 不同数据需要不同积分
   - 基础数据: 120 积分
   - 资金流向: 2000 积分
   - 行业资金: 5000 积分
3. **调用频率限制**:
   - 每分钟最多 500 次
   - 每日最多 100,000 次
4. **数据更新**: 资金流向每日收盘后更新

## 故障排除

### API 连接失败
```bash
# 检查 Token 是否正确
python3 -c "import tushare; print(tushare.__version__)"
```

### 无数据返回
- 检查日期格式是否正确 (YYYYMMDD)
- 确认 TuShare 积分是否足够
- 查看网络连接

### 告警未触发
- 检查阈值配置
- 确认数据是否已更新
