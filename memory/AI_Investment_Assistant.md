# AI æŠ•èµ„åŠ©æ‰‹ï¼šLLM è´¢æŠ¥è§£è¯»/ä¼°å€¼æŠ¥å‘Šç”Ÿæˆ
> å­¦ä¹ ç¬”è®° | ç‰ˆæœ¬ï¼š1.0 | 2026-02-03

---

## ä¸€ã€AI æŠ•èµ„åŠ©æ‰‹æ¦‚è¿°

### 1.1 åº”ç”¨åœºæ™¯

```
AI æŠ•èµ„åŠ©æ‰‹åº”ç”¨åœºæ™¯

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   AI æŠ•èµ„åŠ©æ‰‹                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   è´¢æŠ¥è§£è¯»      â”‚   ä¼°å€¼åˆ†æ      â”‚   æŠ•èµ„é—®ç­”          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ è‡ªåŠ¨æå–å…³é”®  â”‚ â€¢ DCF ä¼°å€¼      â”‚ â€¢ è¡Œä¸šåˆ†æ          â”‚
â”‚ â€¢ è¯†åˆ«å¼‚å¸¸æŒ‡æ ‡  â”‚ â€¢ ç›¸å¯¹ä¼°å€¼      â”‚ â€¢ å…¬å¸å¯¹æ¯”          â”‚
â”‚ â€¢ ç”Ÿæˆæ‘˜è¦      â”‚ â€¢ ä¼°å€¼æŠ¥å‘Š      â”‚ â€¢ æŠ•èµ„å»ºè®®          â”‚
â”‚ â€¢ è¶‹åŠ¿åˆ†æ      â”‚ â€¢ ä¼°å€¼å¯¹æ¯”      â”‚ â€¢ é£é™©æç¤º          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æŠ€æœ¯æ¶æ„

```
AI æŠ•èµ„åŠ©æ‰‹æ¶æ„

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç”¨æˆ·ç•Œé¢                              â”‚
â”‚              (Streamlit/å‘½ä»¤è¡Œ/API)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ„å›¾è¯†åˆ«                              â”‚
â”‚              (åˆ¤æ–­ç”¨æˆ·éœ€æ±‚ç±»å‹)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•°æ®å¤„ç†                              â”‚
â”‚          (è·å–è´¢åŠ¡æ•°æ®/è¡Œæƒ…æ•°æ®)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LLM åˆ†æ                              â”‚
â”‚              (è´¢æŠ¥è§£è¯»/ä¼°å€¼åˆ†æ)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è¾“å‡ºç”Ÿæˆ                              â”‚
â”‚              (æŠ¥å‘Š/å»ºè®®/å›ç­”)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€LLM è´¢æŠ¥è§£è¯»

### 2.1 è´¢æŠ¥æ•°æ®è·å–ä¸ç»“æ„åŒ–

```python
import akshare as ak
import pandas as pd
from datetime import datetime

def get_financial_data(stock_code):
    """è·å–è´¢åŠ¡æ•°æ®"""
    data = {}
    
    # è´¢åŠ¡æŒ‡æ ‡
    try:
        indicator = ak.stock_fina_indicator(symbol=stock_code)
        if len(indicator) > 0:
            latest = indicator.iloc[-1]
            data['indicators'] = {
                'roe': latest.get('roe', 0),
                'netprofit_margin': latest.get('netprofit_margin', 0),
                'grossprofit_margin': latest.get('grossprofit_margin', 0),
                'revenue_yoy': latest.get('revenue_year_on_year', 0),
                'profit_yoy': latest.get('profit_year_on_year', 0),
                'eps': latest.get('eps', 0),
                'bvps': latest.get('bps', 0)
            }
    except Exception as e:
        print(f"è·å–è´¢åŠ¡æŒ‡æ ‡å¤±è´¥: {e}")
    
    # åˆ©æ¶¦è¡¨
    try:
        income = ak.stock_income_statement(symbol=stock_code)
        if len(income) > 0:
            latest = income.iloc[-1]
            data['income'] = {
                'revenue': latest.get('operating_revenue', latest.get('total_operate_income', 0)),
                'net_profit': latest.get('net_profit', latest.get('net_profit_attributable', 0)),
                'operating_profit': latest.get('operating_profit', 0)
            }
    except Exception as e:
        print(f"è·å–åˆ©æ¶¦è¡¨å¤±è´¥: {e}")
    
    # èµ„äº§è´Ÿå€ºè¡¨
    try:
        balance = ak.stock_balance_sheet(symbol=stock_code)
        if len(balance) > 0:
            latest = balance.iloc[-1]
            data['balance'] = {
                'total_assets': latest.get('total_assets', 0),
                'total_liabilities': latest.get('total_liabilities', 0),
                'total_equity': latest.get('total_hldr_eqy_excl_min_int', latest.get('total_owner_equity', 0))
            }
    except Exception as e:
        print(f"è·å–èµ„äº§è´Ÿå€ºè¡¨å¤±è´¥: {e}")
    
    return data

# ç¤ºä¾‹
data = get_financial_data("600519")
print(data)
```

### 2.2 è´¢æŠ¥åˆ†æ Prompt

```python
FINANCIAL_ANALYSIS_PROMPT = """
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„è´¢åŠ¡åˆ†æå¸ˆã€‚è¯·åˆ†æä»¥ä¸‹è´¢åŠ¡æ•°æ®å¹¶ç»™å‡ºè¯¦ç»†æŠ¥å‘Šï¼š

ã€å…¬å¸ä¿¡æ¯ã€‘
å…¬å¸ä»£ç ï¼š{stock_code}
åˆ†ææ—¥æœŸï¼š{analysis_date}

ã€è´¢åŠ¡æŒ‡æ ‡ã€‘
- ROEï¼ˆå‡€èµ„äº§æ”¶ç›Šç‡ï¼‰ï¼š{roe:.2f}%
- å‡€åˆ©æ¶¦ç‡ï¼š{netprofit_margin:.2f}%
- æ¯›åˆ©ç‡ï¼š{grossprofit_margin:.2f}%
- è¥æ”¶å¢é•¿ç‡ï¼š{revenue_yoy:.2f}%
- å‡€åˆ©æ¶¦å¢é•¿ç‡ï¼š{profit_yoy:.2f}%
- æ¯è‚¡æ”¶ç›Šï¼ˆEPSï¼‰ï¼š{eps:.2f}å…ƒ
- æ¯è‚¡å‡€èµ„äº§ï¼ˆBPSï¼‰ï¼š{bvps:.2f}å…ƒ

ã€åˆ©æ¶¦è¡¨æ‘˜è¦ã€‘
- è¥ä¸šæ”¶å…¥ï¼š{revenue:,.0f}ç™¾ä¸‡å…ƒ
- å‡€åˆ©æ¶¦ï¼š{net_profit:,.0f}ç™¾ä¸‡å…ƒ

ã€èµ„äº§è´Ÿå€ºè¡¨æ‘˜è¦ã€‘
- æ€»èµ„äº§ï¼š{total_assets:,.0f}ç™¾ä¸‡å…ƒ
- æ€»è´Ÿå€ºï¼š{total_liabilities:,.0f}ç™¾ä¸‡å…ƒ
- è‚¡ä¸œæƒç›Šï¼š{total_equity:,.0f}ç™¾ä¸‡å…ƒ

è¯·åˆ†æä»¥ä¸‹å†…å®¹ï¼š
1. ç›ˆåˆ©èƒ½åŠ›åˆ†æ
2. æˆé•¿æ€§åˆ†æ
3. å¿å€ºèƒ½åŠ›åˆ†æ
4. è¿è¥æ•ˆç‡åˆ†æ
5. é£é™©æç¤º
6. ç»¼åˆè¯„ä»·

è¯·ç”¨ç®€æ´ã€ä¸“ä¸šçš„è¯­è¨€å›ç­”ï¼Œé¿å…è¿‡å¤šä½¿ç”¨ Markdown æ ¼å¼ã€‚
"""

def generate_financial_report(stock_code, stock_name):
    """ç”Ÿæˆè´¢åŠ¡åˆ†ææŠ¥å‘Š"""
    data = get_financial_data(stock_code)
    
    if not data or 'indicators' not in data:
        return "æ— æ³•è·å–è´¢åŠ¡æ•°æ®"
    
    indicators = data['indicators']
    income = data.get('income', {})
    balance = data.get('balance', {})
    
    # å¡«å…… Prompt
    prompt = FINANCIAL_ANALYSIS_PROMPT.format(
        stock_code=f"{stock_name} ({stock_code})",
        analysis_date=datetime.now().strftime("%Y-%m-%d"),
        roe=indicators.get('roe', 0),
        netprofit_margin=indicators.get('netprofit_margin', 0),
        grossprofit_margin=indicators.get('grossprofit_margin', 0),
        revenue_yoy=indicators.get('revenue_yoy', 0),
        profit_yoy=indicators.get('profit_yoy', 0),
        eps=indicators.get('eps', 0),
        bvps=indicators.get('bvps', 0),
        revenue=income.get('revenue', 0),
        net_profit=income.get('net_profit', 0),
        total_assets=balance.get('total_assets', 0),
        total_liabilities=balance.get('total_liabilities', 0),
        total_equity=balance.get('total_equity', 0)
    )
    
    return prompt
```

### 2.3 LLM é›†æˆ

```python
import os

# ä½¿ç”¨ OpenAI API
def call_llm(prompt, model="gpt-4"):
    """è°ƒç”¨ LLM"""
    from openai import OpenAI
    
    client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))
    
    response = client.chat.completions.create(
        model=model,
        messages=[
            {"role": "system", "content": "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æŠ•èµ„é¡¾é—®å’Œè´¢åŠ¡åˆ†æå¸ˆã€‚"},
            {"role": "user", "content": prompt}
        ],
        temperature=0.7,
        max_tokens=2000
    )
    
    return response.choices[0].message.content

# ä½¿ç”¨ Claude API
def call_claude(prompt, model="claude-3-5-sonnet-20241022"):
    """è°ƒç”¨ Claude"""
    import anthropic
    
    client = anthropic.Anthropic(api_key=os.getenv("ANTHROPIC_API_KEY"))
    
    response = client.messages.create(
        model=model,
        max_tokens=2000,
        messages=[
            {"role": "user", "content": prompt}
        ]
    )
    
    return response.content[0].text

# ä½¿ç”¨ MiniMax API
def call_minimax(prompt):
    """è°ƒç”¨ MiniMax"""
    from openai import OpenAI
    
    client = OpenAI(
        api_key=os.getenv("MINIMAX_API_KEY"),
        base_url="https://api.minimax.io/anthropic"
    )
    
    response = client.chat.completions.create(
        model="MiniMax-M2.1",
        messages=[
            {"role": "system", "content": "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æŠ•èµ„é¡¾é—®å’Œè´¢åŠ¡åˆ†æå¸ˆã€‚"},
            {"role": "user", "content": prompt}
        ],
        temperature=0.7,
        max_tokens=2000
    )
    
    return response.choices[0].message.content
```

---

## ä¸‰ã€ä¼°å€¼æŠ¥å‘Šç”Ÿæˆ

### 3.1 ä¼°å€¼åˆ†æ Prompt

```python
VALUATION_REPORT_PROMPT = """
ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æŠ•èµ„åˆ†æå¸ˆã€‚è¯·å¯¹ä»¥ä¸‹å…¬å¸è¿›è¡Œä¼°å€¼åˆ†æå¹¶ç”Ÿæˆè¯¦ç»†æŠ¥å‘Šï¼š

ã€å…¬å¸ä¿¡æ¯ã€‘
å…¬å¸ä»£ç ï¼š{stock_code}
å½“å‰è‚¡ä»·ï¼š{current_price:.2f}
è¡Œä¸šï¼š{industry}

ã€è´¢åŠ¡æ•°æ®ã€‘
- æœ€æ–°å¸‚ç›ˆç‡ï¼ˆP/Eï¼‰ï¼š{pe:.2f}
- å¸‚å‡€ç‡ï¼ˆP/Bï¼‰ï¼š{pb:.2f}
- è‚¡æ¯ç‡ï¼š{dividend_yield:.2f}%
- ROEï¼š{roe:.2f}%
- è¥æ”¶å¢é•¿ç‡ï¼š{revenue_growth:.2f}%

ã€è¡Œä¸šæ•°æ®ã€‘
- è¡Œä¸šå¹³å‡ P/Eï¼š{industry_pe:.2f}
- è¡Œä¸šå¹³å‡ P/Bï¼š{industry_pb:.2f}

ã€å†å²ä¼°å€¼åŒºé—´ã€‘
- 5 å¹´æœ€ä½ P/Eï¼š{pe_5y_low:.2f}
- 5 å¹´æœ€é«˜ P/Eï¼š{pe_5y_high:.2f}
- 5 å¹´å¹³å‡ P/Eï¼š{pe_5y_avg:.2f}

è¯·åˆ†æä»¥ä¸‹å†…å®¹ï¼š
1. ä¼°å€¼æ°´å¹³åˆ¤æ–­ï¼ˆå½“å‰ä¼°å€¼åœ¨å†å²åŒºé—´çš„ä½ç½®ï¼‰
2. ä¸è¡Œä¸šå¯¹æ¯”åˆ†æ
3. ä¼°å€¼åˆç†æ€§è¯„ä¼°
4. ä¼°å€¼é£é™©æç¤º
5. ä¼°å€¼åŒºé—´é¢„æµ‹
6. æŠ•èµ„å»ºè®®

è¯·ç»™å‡ºï¼š
- åˆç†ä¼°å€¼åŒºé—´
- å½“å‰ä¼°å€¼è¯„çº§ï¼ˆä½ä¼°/åˆç†/é«˜ä¼°ï¼‰
- é£é™©è¯„çº§ï¼ˆä½/ä¸­/é«˜ï¼‰
- æŠ•èµ„è¯„çº§ï¼ˆä¹°å…¥/æŒæœ‰/å–å‡ºï¼‰

è¯·ç”¨ç®€æ´ã€ä¸“ä¸šçš„è¯­è¨€å›ç­”ï¼Œé¿å…è¿‡å¤šä½¿ç”¨ Markdown æ ¼å¼ã€‚
"""

def generate_valuation_report(stock_code, stock_name, current_price, pe, pb, 
                               industry, industry_pe, industry_pb):
    """ç”Ÿæˆä¼°å€¼æŠ¥å‘Š"""
    prompt = VALUATION_REPORT_PROMPT.format(
        stock_code=f"{stock_name} ({stock_code})",
        current_price=current_price,
        industry=industry,
        pe=pe,
        pb=pb,
        dividend_yield=1.5,  # å‡è®¾
        roe=15.0,  # å‡è®¾
        revenue_growth=10.0,  # å‡è®¾
        industry_pe=industry_pe,
        industry_pb=industry_pb,
        pe_5y_low=15.0,  # å‡è®¾
        pe_5y_high=35.0,  # å‡è®¾
        pe_5y_avg=25.0  # å‡è®¾
    )
    
    return prompt
```

---

## å››ã€AI æŠ•èµ„åŠ©æ‰‹å®ç°

### 4.1 å®Œæ•´åŠ©æ‰‹ç±»

```python
import streamlit as st
import pandas as pd
import akshare as ak
from datetime import datetime

class InvestmentAssistant:
    def __init__(self):
        self.capabilities = {
            "è´¢æŠ¥åˆ†æ": self.analyze_financials,
            "ä¼°å€¼åˆ†æ": self.analyze_valuation,
            "æŠ•èµ„å»ºè®®": self.get_investment_advice,
            "è¡Œä¸šåˆ†æ": self.analyze_industry,
            "å…¬å¸å¯¹æ¯”": self.compare_companies,
            "é£é™©è¯„ä¼°": self.assess_risk
        }
    
    def analyze_financials(self, stock_code, stock_name):
        """è´¢æŠ¥åˆ†æ"""
        # è·å–æ•°æ®
        data = get_financial_data(stock_code)
        
        # ç”ŸæˆæŠ¥å‘Š
        prompt = generate_financial_report(stock_code, stock_name)
        
        # è°ƒç”¨ LLM
        report = call_minimax(prompt)
        
        return report
    
    def analyze_valuation(self, stock_code, stock_name, current_price, pe, pb):
        """ä¼°å€¼åˆ†æ"""
        # è·å–è¡Œä¸šæ•°æ®
        industry = "åŠå¯¼ä½“"  # å‡è®¾
        industry_pe = 30.0
        industry_pb = 4.0
        
        # ç”ŸæˆæŠ¥å‘Š
        prompt = generate_valuation_report(
            stock_code, stock_name, current_price, pe, pb,
            industry, industry_pe, industry_pb
        )
        
        # è°ƒç”¨ LLM
        report = call_minimax(prompt)
        
        return report
    
    def get_investment_advice(self, stock_code, stock_name):
        """æŠ•èµ„å»ºè®®"""
        prompt = f"""
        è¯·å¯¹ {stock_name} ({stock_code}) ç»™å‡ºæŠ•èµ„å»ºè®®ã€‚
        
        åˆ†æç»´åº¦ï¼š
        1. å½“å‰å¸‚åœºç¯å¢ƒ
        2. å…¬å¸åŸºæœ¬é¢
        3. æŠ€æœ¯é¢åˆ†æ
        4. é£é™©å› ç´ 
        5. æŠ•èµ„å»ºè®®
        
        è¯·ç»™å‡ºï¼š
        - æŠ•èµ„è¯„çº§ï¼ˆä¹°å…¥/æŒæœ‰/å–å‡ºï¼‰
        - ç›®æ ‡ä»·
        - æ­¢æŸä»·
        - æŒæœ‰æœŸé™
        - ä»“ä½å»ºè®®
        """
        
        return call_minimax(prompt)
    
    def analyze_industry(self, industry_name):
        """è¡Œä¸šåˆ†æ"""
        prompt = f"""
        è¯·å¯¹ {industry_name} è¡Œä¸šè¿›è¡Œæ·±åº¦åˆ†æï¼š
        
        åˆ†æç»´åº¦ï¼š
        1. è¡Œä¸šè§„æ¨¡å’Œå¢é•¿è¶‹åŠ¿
        2. ç«äº‰æ ¼å±€
        3. æ”¿ç­–ç¯å¢ƒ
        4. æŠ€æœ¯å‘å±•è¶‹åŠ¿
        5. é£é™©å› ç´ 
        6. æŠ•èµ„æœºä¼š
        
        è¯·ç»™å‡ºè¡Œä¸šæŠ•èµ„è¯„çº§ã€‚
        """
        
        return call_minimax(prompt)
    
    def compare_companies(self, companies):
        """å…¬å¸å¯¹æ¯”"""
        prompt = f"""
        è¯·å¯¹ä»¥ä¸‹å…¬å¸è¿›è¡Œå¯¹æ¯”åˆ†æï¼š
        
        å…¬å¸åˆ—è¡¨ï¼š
        {chr(10).join([f'- {c}' for c in companies])}
        
        åˆ†æç»´åº¦ï¼š
        1. ç›ˆåˆ©èƒ½åŠ›å¯¹æ¯”
        2. æˆé•¿æ€§å¯¹æ¯”
        3. ä¼°å€¼å¯¹æ¯”
        4. é£é™©å¯¹æ¯”
        5. ç»¼åˆè¯„ä»·
        6. æŠ•èµ„å»ºè®®
        
        è¯·ç»™å‡ºï¼š
        - æœ€ä½³æŠ•èµ„æ ‡çš„
        - å„å…¬å¸ä¼˜åŠ£åŠ¿
        """
        
        return call_minimax(prompt)
    
    def assess_risk(self, stock_code, stock_name):
        """é£é™©è¯„ä¼°"""
        prompt = f"""
        è¯·å¯¹ {stock_name} ({stock_code}) è¿›è¡Œé£é™©è¯„ä¼°ï¼š
        
        é£é™©ç»´åº¦ï¼š
        1. å¸‚åœºé£é™©
        2. è¡Œä¸šé£é™©
        3. å…¬å¸ç»è¥é£é™©
        4. è´¢åŠ¡é£é™©
        5. æµåŠ¨æ€§é£é™©
        6. åœ°ç¼˜æ”¿æ²»é£é™©
        
        è¯·ç»™å‡ºï¼š
        - é£é™©ç­‰çº§ï¼ˆä½/ä¸­/é«˜ï¼‰
        - ä¸»è¦é£é™©å› ç´ 
        - é£é™©åº”å¯¹å»ºè®®
        """
        
        return call_minimax(prompt)
```

### 4.2 Streamlit ç•Œé¢

```python
import streamlit as st
import pandas as pd
import akshare as ak

# åˆå§‹åŒ–åŠ©æ‰‹
assistant = InvestmentAssistant()

st.title("ğŸ¤– AI æŠ•èµ„åŠ©æ‰‹")

# ä¾§è¾¹æ 
st.sidebar.header("åŠŸèƒ½é€‰æ‹©")
function = st.sidebar.selectbox(
    "é€‰æ‹©åŠŸèƒ½",
    ["è´¢æŠ¥åˆ†æ", "ä¼°å€¼åˆ†æ", "æŠ•èµ„å»ºè®®", "è¡Œä¸šåˆ†æ", "å…¬å¸å¯¹æ¯”", "é£é™©è¯„ä¼°"]
)

# è‚¡ç¥¨é€‰æ‹©
st.sidebar.subheader("è‚¡ç¥¨é€‰æ‹©")
stock_name = st.sidebar.text_input("å…¬å¸åç§°", "è´µå·èŒ…å°")
stock_code = st.sidebar.text_input("è‚¡ç¥¨ä»£ç ", "600519")

# ä¸»å†…å®¹åŒº
if function == "è´¢æŠ¥åˆ†æ":
    st.header("ğŸ“Š è´¢æŠ¥åˆ†æ")
    if st.button("ç”Ÿæˆè´¢æŠ¥åˆ†æ"):
        with st.spinner("æ­£åœ¨åˆ†æè´¢æŠ¥..."):
            report = assistant.analyze_financials(stock_code, stock_name)
            st.write(report)

elif function == "ä¼°å€¼åˆ†æ":
    st.header("ğŸ’° ä¼°å€¼åˆ†æ")
    col1, col2 = st.columns(2)
    with col1:
        current_price = st.number_input("å½“å‰è‚¡ä»·", value=1800.0)
    with col2:
        pe = st.number_input("å¸‚ç›ˆç‡ P/E", value=30.0)
    
    if st.button("ç”Ÿæˆä¼°å€¼åˆ†æ"):
        with st.spinner("æ­£åœ¨åˆ†æä¼°å€¼..."):
            report = assistant.analyze_valuation(stock_code, stock_name, current_price, pe, 5.0)
            st.write(report)

elif function == "æŠ•èµ„å»ºè®®":
    st.header("ğŸ’¡ æŠ•èµ„å»ºè®®")
    if st.button("è·å–æŠ•èµ„å»ºè®®"):
        with st.spinner("æ­£åœ¨ç”Ÿæˆå»ºè®®..."):
            advice = assistant.get_investment_advice(stock_code, stock_name)
            st.write(advice)

elif function == "è¡Œä¸šåˆ†æ":
    st.header("ğŸ“ˆ è¡Œä¸šåˆ†æ")
    industry = st.text_input("è¡Œä¸šåç§°", "åŠå¯¼ä½“")
    if st.button("åˆ†æè¡Œä¸š"):
        with st.spinner("æ­£åœ¨åˆ†æè¡Œä¸š..."):
            analysis = assistant.analyze_industry(industry)
            st.write(analysis)

elif function == "å…¬å¸å¯¹æ¯”":
    st.header("âš–ï¸ å…¬å¸å¯¹æ¯”")
    companies = st.text_area("è¾“å…¥å…¬å¸åˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰", "è´µå·èŒ…å°\näº”ç²®æ¶²\næ´‹æ²³è‚¡ä»½")
    if st.button("å¯¹æ¯”å…¬å¸"):
        company_list = [c.strip() for c in companies.split('\n') if c.strip()]
        with st.spinner("æ­£åœ¨å¯¹æ¯”..."):
            comparison = assistant.compare_companies(company_list)
            st.write(comparison)

elif function == "é£é™©è¯„ä¼°":
    st.header("âš ï¸ é£é™©è¯„ä¼°")
    if st.button("è¯„ä¼°é£é™©"):
        with st.spinner("æ­£åœ¨è¯„ä¼°é£é™©..."):
            risk = assistant.assess_risk(stock_code, stock_name)
            st.write(risk)
```

---

## äº”ã€Prompt å·¥ç¨‹æœ€ä½³å®è·µ

### 5.1 Prompt ç»“æ„

```
æ ‡å‡† Prompt ç»“æ„

1. è§’è‰²å®šä¹‰ï¼šä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æŠ•èµ„åˆ†æå¸ˆ
2. ä»»åŠ¡æè¿°ï¼šè¯·åˆ†æä»¥ä¸‹å…¬å¸çš„è´¢åŠ¡æ•°æ®
3. æ•°æ®æä¾›ï¼šå…·ä½“çš„è´¢åŠ¡æ•°æ®
4. åˆ†æè¦æ±‚ï¼šæ˜ç¡®çš„åˆ†æç»´åº¦
5. è¾“å‡ºæ ¼å¼ï¼šæœŸæœ›çš„å›ç­”æ ¼å¼
6. çº¦æŸæ¡ä»¶ï¼šé¿å…çš„äº‹é¡¹
```

### 5.2 é«˜æ•ˆ Prompt ç¤ºä¾‹

```python
# å¥½çš„ Prompt
GOOD_PROMPT = """
ä½ æ˜¯ä¸€ä½èµ„æ·±çš„æŠ•èµ„åˆ†æå¸ˆã€‚è¯·åˆ†æ {stock} çš„æŠ•èµ„ä»·å€¼ã€‚

è¦æ±‚ï¼š
1. åˆ†æè¦ç®€æ´æ˜äº†
2. ç»™å‡ºæ˜ç¡®çš„æŠ•èµ„å»ºè®®
3. åˆ—å‡ºå…³é”®é£é™©å› ç´ 

è¯·åœ¨ 500 å­—å†…å®Œæˆåˆ†æã€‚
"""

# ä¸å¥½çš„ Prompt
BAD_PROMPT = """
åˆ†æä¸€ä¸‹è¿™ä¸ªè‚¡ç¥¨æ€ä¹ˆæ ·ï¼Ÿ
"""

# ä¼˜åŒ–åçš„ Prompt
OPTIMIZED_PROMPT = """
ä½œä¸ºä¸“ä¸šæŠ•èµ„åˆ†æå¸ˆï¼Œè¯·å¯¹ {stock} è¿›è¡Œå¿«é€Ÿè¯„ä¼°ï¼š

ã€å…³é”®æ•°æ®ã€‘
- å½“å‰è‚¡ä»·ï¼š{price}
- P/Eï¼š{pe}
- P/Bï¼š{pb}
- ROEï¼š{roe}
- è¥æ”¶å¢é•¿ï¼š{revenue_growth}%

ã€åˆ†æè¦æ±‚ã€‘
1. ä¼°å€¼æ°´å¹³ï¼ˆ1-2å¥è¯ï¼‰
2. æ ¸å¿ƒæŠ•èµ„é€»è¾‘ï¼ˆ1-2å¥è¯ï¼‰
3. ä¸»è¦é£é™©ï¼ˆ1-2å¥è¯ï¼‰
4. æŠ•èµ„è¯„çº§ï¼šä¹°å…¥/æŒæœ‰/å–å‡º

è¯·ç›´æ¥ç»™å‡ºç»“è®ºï¼Œé¿å…å†—é•¿åˆ†æã€‚
"""
```

### 5.3 å¸¸è§é—®é¢˜å¤„ç†

```python
# å¤„ç†æ•°æ®ç¼ºå¤±
def safe_get_value(data, key, default="æ•°æ®æš‚æ— "):
    """å®‰å…¨è·å–æ•°æ®"""
    try:
        value = data.get(key, default)
        if value is None:
            return default
        return value
    except:
        return default

# å¤„ç† LLM è¶…æ—¶
import timeout_decorator

@timeout_decorator.timeout(30)
def call_llm_with_timeout(prompt):
    """å¸¦è¶…æ—¶çš„ LLM è°ƒç”¨"""
    return call_llm(prompt)

# å¤„ç†é”™è¯¯
def handle_llm_error(func):
    """LLM è°ƒç”¨é”™è¯¯å¤„ç†"""
    def wrapper(*args, **kwargs):
        try:
            return func(*args, **kwargs)
        except Exception as e:
            return f"åˆ†æå¤±è´¥ï¼š{str(e)}ã€‚è¯·ç¨åé‡è¯•ã€‚"
    return wrapper
```

---

## å…­ã€å­¦ä¹ è¦ç‚¹æ€»ç»“

### 6.1 AI æŠ•èµ„åŠ©æ‰‹æ ¸å¿ƒèƒ½åŠ›

| èƒ½åŠ› | è¯´æ˜ | æŠ€æœ¯ |
|------|------|------|
| **è´¢æŠ¥è§£è¯»** | è‡ªåŠ¨æå–å…³é”®æŒ‡æ ‡ã€å¼‚å¸¸è¯†åˆ« | æ•°æ®æŠ“å– + LLM |
| **ä¼°å€¼åˆ†æ** | DCF/ç›¸å¯¹ä¼°å€¼ã€ä¼°å€¼åŒºé—´ | ä¼°å€¼æ¨¡å‹ + LLM |
| **æŠ•èµ„é—®ç­”** | è¡Œä¸šåˆ†æã€å…¬å¸å¯¹æ¯” | LLM |
| **é£é™©è¯„ä¼°** | å¤šç»´åº¦é£é™©è¯†åˆ« | LLM |
| **æŠ¥å‘Šç”Ÿæˆ** | è‡ªåŠ¨ç”Ÿæˆåˆ†ææŠ¥å‘Š | LLM |

### 6.2 LLM é€‰æ‹©

| LLM | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **GPT-4** | èƒ½åŠ›å¼º | æ˜‚è´µ | å¤æ‚åˆ†æ |
| **Claude** | é•¿æ–‡æœ¬ | è¾ƒæ…¢ | é•¿æŠ¥å‘Š |
| **MiniMax** | ä¾¿å®œã€å¿«é€Ÿ | èƒ½åŠ›ä¸€èˆ¬ | æ—¥å¸¸åˆ†æ |
| **æœ¬åœ°æ¨¡å‹** | éšç§ | éœ€è¦èµ„æº | æ•æ„Ÿæ•°æ® |

### 6.3 æœ€ä½³å®è·µ

1. **æ˜ç¡®ä»»åŠ¡**ï¼šæ¸…æ™°å®šä¹‰åˆ†æç›®æ ‡
2. **æä¾›æ•°æ®**ï¼šç»™å‡ºå…³é”®è´¢åŠ¡æ•°æ®
3. **çº¦æŸè¾“å‡º**ï¼šé™åˆ¶å›ç­”é•¿åº¦å’Œæ ¼å¼
4. **é”™è¯¯å¤„ç†**ï¼šå¤„ç† API å¼‚å¸¸
5. **æŒç»­ä¼˜åŒ–**ï¼šæ ¹æ®åé¦ˆæ”¹è¿› Prompt

---

## ä¸ƒã€å»¶ä¼¸å­¦ä¹ 

### 7.1 æ¨èç ”ç©¶

1. Prompt Engineering
2. RAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰
3. å¾®è°ƒ LLM
4. å¤šæ¨¡æ€åˆ†æ

### 7.2 å¾…å®è·µ

1. å»ºç«‹è¡Œä¸šåˆ†æçŸ¥è¯†åº“
2. å®ç°å®æ—¶æ•°æ®é›†æˆ
3. å¼€å‘è¯­éŸ³åŠ©æ‰‹
4. æ„å»ºæŠ•èµ„å†³ç­–ç³»ç»Ÿ

---

*æœ¬å­¦ä¹ ç¬”è®°ç”± Clawdbot è‡ªä¸»å­¦ä¹ æ•´ç†*
*ç‰ˆæœ¬ï¼š1.0 | 2026-02-03*
