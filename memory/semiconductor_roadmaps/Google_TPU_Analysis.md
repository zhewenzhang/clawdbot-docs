# 谷歌 TPU 深度分析
> 学习笔记 | 版本：1.0 | 2026-02-03

---

## 一、谷歌芯片矩阵

```
谷歌芯片业务

┌─────────────────────────────────────────────────────────┐
│                   Google Silicon                       │
├─────────────────┬─────────────────┬─────────────────────┤
│   TPU（AI）    │   Pixel 手机    │   服务器            │
├─────────────────┬─────────────────┼─────────────────────┤
| • TPU v6       | • Tensor G4    | • 定制服务器        |
| • TPU v7      | • Tensor G5    | • 安全芯片          |
| • Edge TPU    | • Titan M2     | • 网络芯片          |
└─────────────────┴─────────────────┴─────────────────────┘

TPU 业务规模（2024）：
- 云服务：~$5B
- 内部使用：~$5B
- 总计：~$10B
```

---

## 二、TPU 演进历史

### 2.1 TPU 时间线

| 代际 | 发布时间 | 制程 | 算力 | 内存带宽 | 位置 |
|------|----------|------|------|----------|------|
| **TPU v1** | 2016 | 28nm | 92 TOPS | 34 GB/s | 内部 |
| **TPU v2** | 2017 | 16nm | 180 TOPS | 700 GB/s | 云+内部 |
| **TPU v3** | 2018 | 16nm | 420 TOPS | 900 GB/s | 云+内部 |
| **TPU v4** | 2020 | 7nm | 275 TOPS | 1.4 TB/s | 云+内部 |
| **TPU v5e** | 2023 | 5nm | 200 TOPS | 400 GB/s | 云 |
| **TPU v5p** | 2023 | 5nm | 2000 TOPS | 4.8 TB/s | 云 |
| **TPU v6** | 2024 | 3nm | TBD | TBD | 云+内部 |
| **TPU v7** | 2026 | 3nm | TBD | TBD | 开发中 |

### 2.2 TPU v6 规格预测

| 参数 | 预期规格 | 相比 v5p |
|------|----------|----------|
| **制程** | 3nm (TSMC) | 5nm→3nm |
| **算力** | 5000 TFLOPS | +150% |
| **INT8** | 5000 TOPS | +150% |
| **HBM** | HBM3e | 4.8TB/s |
| **功耗** | 700W | +40% |
| **互连** | 800G IC | +100% |

### 2.3 制程演进

| 制程 | 密度 | 适用 TPU | 时间 |
|------|------|----------|------|
| **28nm** | 145MTr/mm² | TPU v1 | 2016 |
| **16nm** | 145MTr/mm² | TPU v2/v3 | 2017 |
| **7nm** | 145MTr/mm² | TPU v4 | 2020 |
| **5nm** | 180MTr/mm² | TPU v5 | 2023 |
| **3nm** | 220MTr/mm² | TPU v6 | 2024 |
| **2nm** | 250MTr/mm² | TPU v7 | 2026 |

---

## 三、Cloud TPU 详解

### 3.1 Cloud TPU 产品线

| 产品 | 算力 | 内存 | 互连 | 价格/小时 | 适用场景 |
|------|------|------|------|-----------|----------|
| **TPU v5e** | 200 TOPS | 16GB | 200 Gbps | $1.35 | 入门训练 |
| **TPU v5p** | 2000 TOPS | 128GB | 800 Gbps | $4.50 | 主流训练 |
| **TPU v6** | 5000 TOPS | 256GB | 800 Gbps | $8.00 | 高端训练 |
| **TPU v4 Pod** | 1 EFLOPS | 多 TB | 10Tbps | $32/小时 | 大规模训练 |

### 3.2 TPU v5p 详细规格

| 参数 | 规格 | 说明 |
|------|------|------|
| **制程** | 5nm (TSMC) | 先进制程 |
| **芯片数** | 8 个 TPU 芯片 | 组成 4 个 TPU 核心 |
| **算力** | 2000 TOPS (INT8) | 训练+推理 |
| **FP8** | 2000 TFLOPS | 训练精度 |
| **内存** | 128GB HBM3 | 带宽 4.8 TB/s |
| **互连** | 800 Gbps | 芯片间通信 |
| **功耗** | 500W | TDP |
| **芯片面积** | 400 mm² | 大芯片 |

### 3.3 TPU Pod 配置

| Pod 规模 | 芯片数 | 算力 | 内存 | 适用场景 |
|----------|--------|------|------|----------|
| **v5e Pod** | 256 | 100 PFLOPS | 8 TB | 中型训练 |
| **v5p Pod** | 4096 | 16 EFLOPS | 1 PB | 大型训练 |
| **v4 Pod** | 4096 | 1 EFLOPS | 512 TB | 超大规模 |

---

## 四、TPU 架构分析

### 4.1 TPU 芯片架构

```
TPU v5p 芯片架构

┌─────────────────────────────────────────────────────────┐
│                   TPU v5p Chip                         │
├─────────────────┬─────────────────┬─────────────────────┤
│   Matrix Multiply Unit (MXU)                          │
│   ┌─────────────────────────────────────────┐        │
│   │  128x128 MAC Array  │  8 TFLOPS/mxu   │        │
│   └─────────────────────────────────────────┘        │
├─────────────────┬─────────────────┬─────────────────────┤
│   Unified Buffer (UC)   │   Vector/Scalar Units   │
│   128MB HBM3           │   通用计算              │
├─────────────────┬─────────────────┬─────────────────────┤
│   Interconnect   │   PCIe Gen4   │   高带宽接口       │
│   800 Gbps       │   x16         │   主机通信         │
└─────────────────┴─────────────────┴─────────────────────┘
```

### 4.2 MXU 架构

| 参数 | TPU v4 | TPU v5 | TPU v6 (预期) |
|------|--------|--------|---------------|
| **阵列大小** | 128x128 | 128x128 | 256x256 |
| **MAC 数量** | 16K | 16K | 64K |
| **FP8 性能** | 128 TFLOPS | 256 TFLOPS | 1000 TFLOPS |
| **频率** | 1.2 GHz | 1.5 GHz | 2.0 GHz |

### 4.3 与 NVIDIA 对比

| 参数 | TPU v5p | H100 | B200 | TPU v6 (预期) |
|------|---------|------|------|---------------|
| **制程** | 5nm | 4nm | 4nm | 3nm |
| **算力** | 2000 TOPS | 2000 TOPS | 9000 TOPS | 5000 TOPS |
| **HBM** | 128GB | 80GB | 192GB | 256GB |
| **带宽** | 4.8 TB/s | 3.35 TB/s | 8 TB/s | 8 TB/s |
| **价格** | $4.5/小时 | $30K | $50K | $8/小时 |

---

## 五、Edge TPU

### 5.1 Edge TPU 产品线

| 产品 | 算力 | 功耗 | 尺寸 | 应用 |
|------|------|------|------|------|
| **Edge TPU** | 4 TOPS | 0.5W | USB 加密狗 | 边缘推理 |
| **Edge TPU Mini** | 2 TOPS | 0.3W | M.2 | 嵌入式 |
| **Edge TPU Pro** | 8 TOPS | 1W | PCIe | 高端边缘 |
| **Coral Dev Board** | 4 TOPS | 0.5W | 开发板 | 研发 |

### 5.2 Edge TPU 规格

| 参数 | 规格 | 说明 |
|------|------|------|
| **制程** | 28nm | 低功耗 |
| **架构** | 自研 ASIC | 专用推理 |
| **算力** | 4 TOPS (INT8) | 边缘推理 |
| **精度** | INT8/FP16 | 混合精度 |
| **功耗** | 0.5W | 超低功耗 |
| **延迟** | <1ms | 实时推理 |

### 5.3 应用场景

| 场景 | 模型 | Edge TPU 表现 |
|------|------|---------------|
| **图像分类** | MobileNet V3 | 实时 (30fps+) |
| **目标检测** | EfficientDet | 实时 (15fps+) |
| **语义分割** | DeepLab V3 | 实时 (10fps+) |
| **姿态估计** | MoveNet | 实时 (30fps+) |

---

## 六、软件生态

### 6.1 TPU 软件栈

```
TPU 软件栈

┌─────────────────────────────────────────────────────────┐
│   应用层                                                │
│   TensorFlow / JAX / PyTorch                           │
├─────────────────┬─────────────────┬─────────────────────┤
│   XLA 编译器    │   TPU Runtime  │   TFX              │
│   优化编译      │   运行时支持    |   ML 工作流        │
├─────────────────┬─────────────────┬─────────────────────┤
│   硬件抽象层                                             │
│   TPU Driver / TPU Library                            │
├─────────────────┬─────────────────┬─────────────────────┤
│   硬件层                                                │
│   TPU v5p / TPU v6                                    │
└─────────────────┴─────────────────┴─────────────────────┘
```

### 6.2 框架支持

| 框架 | TPU 支持 | 特点 |
|------|----------|------|
| **TensorFlow** | ✅ 完整 | 原生支持 |
| **JAX** | ✅ 完整 | Google 推荐 |
| **PyTorch** | ✅ XLA 桥接 | 需要转换 |
| **TensorRT** | ❌ | 无支持 |

### 6.3 模型支持

| 模型类型 | 优化程度 | 性能提升 |
|----------|----------|----------|
| **Transformer** | ✅ 优秀 | 10x+ |
| **CNN** | ✅ 优秀 | 5x+ |
| **RNN/LSTM** | ✅ 良好 | 3x+ |
| **扩散模型** | ✅ 良好 | 5x+ |

---

## 七、营收与市场

### 7.1 TPU 营收预测

| 年份 | 云服务营收 | 内部使用 | 总计 | 同比增长 |
|------|------------|----------|------|----------|
| **2024** | $5B | $5B | $10B | +50% |
| **2025** | $8B | $7B | $15B | +50% |
| **2026** | $12B | $10B | $22B | +47% |
| **2027** | $18B | $15B | $33B | +50% |

### 7.2 Cloud TPU 市场份额

| 年份 | 谷歌 | 英伟达 | AWS | 其他 |
|------|------|--------|-----|------|
| **2024** | 15% | 60% | 15% | 10% |
| **2025** | 18% | 55% | 17% | 10% |
| **2026** | 22% | 50% | 18% | 10% |
| **2027** | 25% | 45% | 20% | 10% |

### 7.3 竞争优势

| 优势 | 说明 |
|------|------|
| **成本优势** | TCO 低于 NVIDIA |
| **集成优势** | 云+AI 垂直整合 |
| **JAX 生态** | 自研框架优化 |
| **规模优势** | 内部需求驱动 |

---

## 八、学习要点总结

### 8.1 核心数据

| 数据 | 数值 |
|------|------|
| TPU v6 制程 | 3nm |
| TPU v5p 算力 | 2000 TOPS |
| Cloud TPU 份额 | 15% (2024) |
| TPU 营收 | $10B (2024) |

### 8.2 关键趋势

1. **制程升级**：3nm (2024)
2. **成本优势**：TCO 低于 NVIDIA
3. **JAX 生态**：自研框架
4. **Edge TPU**：边缘 AI 布局

### 8.3 跟踪指标

| 指标 | 数据来源 | 频率 |
|------|----------|------|
| **TPU 版本** | 谷歌 I/O | 年度 |
| **Cloud 定价** | 谷歌云 | 不定期 |
| **框架支持** | GitHub | 月度 |
| **市场份额** | Canalys | 季度 |

---

## 九、延伸学习

### 9.1 待追踪问题

1. TPU v6 何时发布？
2. 谷歌 vs 英伟达竞争？
3. JAX 生态发展？
4. Edge TPU 应用？

### 9.2 推荐研究

1. NVIDIA H100/B200 分析
2. AWS Trainium/Inferentia
3. JAX vs PyTorch
4. 边缘 AI 市场

---

*本学习笔记由 Clawdbot 自主学习整理*
*版本：1.0 | 2026-02-03*
